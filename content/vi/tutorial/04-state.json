{"meta":{"title":"State","prev":"/tutorial/03-components","next":"/tutorial/05-refs","solvable":true,"tutorial":{"setup":"useResult(function () {\n  var options = require('preact').options;\n\n  var oe = options.event;\n  options.event = function(e) {\n    if (oe) oe.apply(this, arguments);\n\n    if (e.currentTarget.localName !== 'button') return;\n    var root = e.currentTarget.parentNode.parentNode;\n    var text = root.innerText.match(/Count:\\s*([\\w.-]*)/i);\n    if (!text) return;\n    if (!text[1].match(/^-?\\d+$/)) {\n      return console.warn('Gá»£i Ã½: cÃ³ váº» báº¡n chÆ°a render {count} á»Ÿ Ä‘Ã¢u Ä‘Ã³.');\n    }\n    setTimeout(function() {\n      var text2 = root.innerText.match(/Count:\\s*([\\w.-]*)/i);\n      if (!text2) {\n        return console.warn('Gá»£i Ã½: báº¡n cÃ³ nhá»› render {count} khÃ´ng?');\n      }\n      if (text2[1] == text[1]) {\n        return console.warn('Gá»£i Ã½: hÃ£y nhá»› gá»i hÃ m \"setter\" Ä‘á»ƒ thay Ä‘á»•i giÃ¡ trá»‹ cá»§a `count`.');\n      }\n      if (!text2[1].match(/^-?\\d+$/)) {\n        return console.warn('Gá»£i Ã½: cÃ³ váº» nhÆ° `count` Ä‘ang Ä‘Æ°á»£c gÃ¡n thÃ nh má»™t giÃ¡ trá»‹ khÃ´ng pháº£i sá»‘.');\n      }\n\n      if (Number(text2[1]) === Number(text[1]) + 1) {\n        solutionCtx.setSolved(true);\n      }\n    }, 10);\n  }\n\n  return function () {\n    options.event = oe;\n  };\n}, []);","initial":"import { render } from 'preact';\nimport { useState } from 'preact/hooks';\n\nfunction MyButton(props) {\n  return <button style={props.style} onClick={props.onClick}>{props.children}</button>\n}\n\nfunction App() {\n  const clicked = () => {\n    // tÄƒng count lÃªn 1 táº¡i Ä‘Ã¢y\n  }\n\n  return (\n    <div>\n      <p class=\"count\">Sá»‘ Ä‘áº¿m:</p>\n      <MyButton style={{ color: 'purple' }} onClick={clicked}>Nháº¥n tÃ´i</MyButton>\n    </div>\n  )\n}\n\nrender(<App />, document.getElementById(\"app\"));","final":"import { render } from 'preact';\nimport { useState } from 'preact/hooks';\n\nfunction MyButton(props) {\n  return <button style={props.style} onClick={props.onClick}>{props.children}</button>\n}\n\nfunction App() {\n  const [count, setCount] = useState(0)\n\n  const clicked = () => {\n    setCount(count + 1)\n  }\n\n  return (\n    <div>\n      <p class=\"count\">Sá»‘ Ä‘áº¿m: {count}</p>\n      <MyButton style={{ color: 'purple' }} onClick={clicked}>Nháº¥n tÃ´i</MyButton>\n    </div>\n  )\n}\n\nrender(<App />, document.getElementById(\"app\"));"}},"html":"<h1>State (Tráº¡ng thÃ¡i)</h1><p>BÃ¢y giá» chÃºng ta Ä‘Ã£ biáº¿t cÃ¡ch táº¡o cÃ¡c pháº§n tá»­ HTML vÃ  thÃ nh pháº§n, cÅ©ng nhÆ° cÃ¡ch truyá»n props vÃ  cÃ¡c hÃ m xá»­ lÃ½ sá»± kiá»‡n cho cáº£ hai báº±ng JSX, Ä‘Ã£ Ä‘áº¿n lÃºc tÃ¬m hiá»ƒu cÃ¡ch cáº­p nháº­t cÃ¢y Virtual DOM.</p>\n<p>NhÆ° Ä‘Ã£ Ä‘á» cáº­p á»Ÿ chÆ°Æ¡ng trÆ°á»›c, cáº£ thÃ nh pháº§n hÃ m vÃ  thÃ nh pháº§n lá»›p Ä‘á»u cÃ³ thá»ƒ cÃ³ <strong>state</strong> (tráº¡ng thÃ¡i) â€“ dá»¯ liá»‡u Ä‘Æ°á»£c lÆ°u trá»¯ bá»Ÿi má»™t thÃ nh pháº§n vÃ  Ä‘Æ°á»£c sá»­ dá»¥ng Ä‘á»ƒ thay Ä‘á»•i cÃ¢y Virtual DOM cá»§a nÃ³. Khi má»™t thÃ nh pháº§n cáº­p nháº­t state cá»§a nÃ³, Preact sáº½ render láº¡i thÃ nh pháº§n Ä‘Ã³ vá»›i giÃ¡ trá»‹ state má»›i. Äá»‘i vá»›i thÃ nh pháº§n hÃ m, Ä‘iá»u nÃ y cÃ³ nghÄ©a lÃ  Preact sáº½ gá»i láº¡i hÃ m Ä‘Ã³, cÃ²n vá»›i thÃ nh pháº§n lá»›p thÃ¬ chá»‰ gá»i láº¡i phÆ°Æ¡ng thá»©c <code>render()</code> cá»§a lá»›p Ä‘Ã³. HÃ£y cÃ¹ng xem vÃ­ dá»¥ cho tá»«ng loáº¡i.</p>\n\n\t\t\t\t<h2 id=\"state-trong-thÃ nh-pháº§n-lá»›p\">\n\t\t\t\t\t<a class=\"fragment-link\" href=\"#state-trong-thÃ nh-pháº§n-lá»›p\">\n\t\t\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" aria-label=\"Link to: State trong thÃ nh pháº§n lá»›p (#state-trong-thÃ nh-pháº§n-lá»›p)\">\n\t\t\t\t\t\t\t<use href=\"/icons.svg#link\" ></use>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</a>\n\t\t\t\t\t<span>State trong thÃ nh pháº§n lá»›p</span>\n\t\t\t\t</h2><p>ThÃ nh pháº§n lá»›p cÃ³ má»™t thuá»™c tÃ­nh <code>state</code>, lÃ  má»™t Ä‘á»‘i tÆ°á»£ng chá»©a dá»¯ liá»‡u mÃ  thÃ nh pháº§n cÃ³ thá»ƒ sá»­ dá»¥ng khi phÆ°Æ¡ng thá»©c <code>render()</code> cá»§a nÃ³ Ä‘Æ°á»£c gá»i. Má»™t thÃ nh pháº§n cÃ³ thá»ƒ gá»i <code>this.setState()</code> Ä‘á»ƒ cáº­p nháº­t thuá»™c tÃ­nh <code>state</code> cá»§a nÃ³ vÃ  yÃªu cáº§u Preact render láº¡i thÃ nh pháº§n Ä‘Ã³.</p>\n\n\t\t\t\t<div class=\"highlight-container\">\n\t\t\t\t\t<pre class=\"highlight\"><code class=\"language-jsx\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">MyButton</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">clicked</span><span class=\"token operator\">:</span> <span class=\"token boolean\">false</span> <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">clicked</span><span class=\"token operator\">:</span> <span class=\"token boolean\">true</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n      <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n        </span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>clicked <span class=\"token operator\">?</span> <span class=\"token string\">'ÄÃ£ nháº¥n'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'ChÆ°a nháº¥n láº§n nÃ o'</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n      </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n    <span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t<p>Khi nháº¥n nÃºt sáº½ gá»i <code>this.setState()</code>, Ä‘iá»u nÃ y khiáº¿n Preact gá»i láº¡i phÆ°Æ¡ng thá»©c <code>render()</code> cá»§a lá»›p. Khi Ä‘Ã³, <code>this.state.clicked</code> Ä‘Ã£ lÃ  <code>true</code>, nÃªn phÆ°Æ¡ng thá»©c <code>render()</code> tráº£ vá» má»™t cÃ¢y Virtual DOM chá»©a vÄƒn báº£n &quot;ÄÃ£ nháº¥n&quot; thay vÃ¬ &quot;ChÆ°a nháº¥n láº§n nÃ o&quot;, khiáº¿n Preact cáº­p nháº­t ná»™i dung nÃºt trÃªn DOM.</p>\n\n\t\t\t\t<h2 id=\"state-trong-thÃ nh-pháº§n-hÃ m-vá»›i-hooks\">\n\t\t\t\t\t<a class=\"fragment-link\" href=\"#state-trong-thÃ nh-pháº§n-hÃ m-vá»›i-hooks\">\n\t\t\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" aria-label=\"Link to: State trong thÃ nh pháº§n hÃ m vá»›i hooks (#state-trong-thÃ nh-pháº§n-hÃ m-vá»›i-hooks)\">\n\t\t\t\t\t\t\t<use href=\"/icons.svg#link\" ></use>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</a>\n\t\t\t\t\t<span>State trong thÃ nh pháº§n hÃ m vá»›i hooks</span>\n\t\t\t\t</h2><p>ThÃ nh pháº§n hÃ m cÅ©ng cÃ³ thá»ƒ cÃ³ state! DÃ¹ chÃºng khÃ´ng cÃ³ thuá»™c tÃ­nh <code>this.state</code> nhÆ° thÃ nh pháº§n lá»›p, má»™t module nhá» Ä‘i kÃ¨m vá»›i Preact cung cáº¥p cÃ¡c hÃ m Ä‘á»ƒ lÆ°u trá»¯ vÃ  lÃ m viá»‡c vá»›i state bÃªn trong thÃ nh pháº§n hÃ m, gá»i lÃ  &quot;hooks&quot;.</p>\n<p>Hooks lÃ  cÃ¡c hÃ m Ä‘áº·c biá»‡t cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i bÃªn trong má»™t thÃ nh pháº§n hÃ m. ChÃºng Ä‘áº·c biá»‡t vÃ¬ chÃºng <strong>ghi nhá»› thÃ´ng tin qua cÃ¡c láº§n render</strong>, giá»‘ng nhÆ° thuá»™c tÃ­nh vÃ  phÆ°Æ¡ng thá»©c trÃªn má»™t class. VÃ­ dá»¥, hook <code>useState</code> tráº£ vá» má»™t máº£ng gá»“m má»™t giÃ¡ trá»‹ vÃ  má»™t hÃ m &quot;setter&quot; cÃ³ thá»ƒ Ä‘Æ°á»£c gá»i Ä‘á»ƒ cáº­p nháº­t giÃ¡ trá»‹ Ä‘Ã³. Khi má»™t thÃ nh pháº§n Ä‘Æ°á»£c gá»i láº¡i (render láº¡i) nhiá»u láº§n, má»i láº§n gá»i <code>useState()</code> sáº½ tráº£ vá» Ä‘Ãºng cÃ¹ng má»™t máº£ng nhÆ° trÆ°á»›c.</p>\n<blockquote>\n<p>â„¹ï¸ <strong><em>Hooks hoáº¡t Ä‘á»™ng nhÆ° tháº¿ nÃ o?</em></strong></p>\n<p>á» phÃ­a bÃªn trong, cÃ¡c hÃ m hook nhÆ° <code>setState</code> hoáº¡t Ä‘á»™ng báº±ng cÃ¡ch lÆ°u trá»¯ dá»¯ liá»‡u trong má»™t chuá»—i cÃ¡c &quot;slot&quot; gáº¯n vá»›i má»—i thÃ nh pháº§n trong cÃ¢y Virtual DOM. Má»—i láº§n gá»i má»™t hook sáº½ sá»­ dá»¥ng má»™t slot, vÃ  tÄƒng má»™t bá»™ Ä‘áº¿m &quot;slot number&quot; ná»™i bá»™ Ä‘á»ƒ láº§n gá»i tiáº¿p theo dÃ¹ng slot tiáº¿p theo. Preact sáº½ Ä‘áº·t láº¡i bá»™ Ä‘áº¿m nÃ y trÆ°á»›c khi gá»i má»—i thÃ nh pháº§n, nÃªn má»—i láº§n gá»i hook sáº½ gáº¯n vá»›i cÃ¹ng má»™t slot khi thÃ nh pháº§n Ä‘Æ°á»£c render nhiá»u láº§n.</p>\n\n\t\t\t\t<div class=\"highlight-container\">\n\t\t\t\t\t<pre class=\"highlight\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">User</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>name<span class=\"token punctuation\">,</span> setName<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Bob\"</span><span class=\"token punctuation\">)</span>    <span class=\"token comment\">// slot 0</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>age<span class=\"token punctuation\">,</span> setAge<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">42</span><span class=\"token punctuation\">)</span>         <span class=\"token comment\">// slot 1</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>online<span class=\"token punctuation\">,</span> setOnline<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span> <span class=\"token comment\">// slot 2</span>\n<span class=\"token punctuation\">}</span></code></pre>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t<p>Äiá»u nÃ y gá»i lÃ  &quot;call site ordering&quot;, vÃ  Ä‘Ã³ lÃ  lÃ½ do táº¡i sao cÃ¡c hook luÃ´n pháº£i Ä‘Æ°á»£c gá»i theo cÃ¹ng má»™t thá»© tá»± trong má»™t thÃ nh pháº§n, vÃ  khÃ´ng Ä‘Æ°á»£c gá»i cÃ³ Ä‘iá»u kiá»‡n hoáº·c trong vÃ²ng láº·p.</p>\n</blockquote>\n<p>HÃ£y xem vÃ­ dá»¥ vá» hook <code>useState</code>:</p>\n\n\t\t\t\t<div class=\"highlight-container\">\n\t\t\t\t\t<pre class=\"highlight\"><code class=\"language-jsx\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'preact/hooks'</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">MyButton</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>clicked<span class=\"token punctuation\">,</span> setClicked<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleClick</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token function\">setClicked</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;</span>button</span> <span class=\"token attr-name\">onClick</span><span class=\"token script language-javascript\"><span class=\"token script-punctuation punctuation\">=</span><span class=\"token punctuation\">{</span>handleClick<span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">></span></span><span class=\"token plain-text\">\n      </span><span class=\"token punctuation\">{</span>clicked <span class=\"token operator\">?</span> <span class=\"token string\">'ÄÃ£ nháº¥n'</span> <span class=\"token operator\">:</span> <span class=\"token string\">'ChÆ°a nháº¥n láº§n nÃ o'</span><span class=\"token punctuation\">}</span><span class=\"token plain-text\">\n    </span><span class=\"token tag\"><span class=\"token tag\"><span class=\"token punctuation\">&lt;/</span>button</span><span class=\"token punctuation\">></span></span>\n  <span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre>\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t<p>Khi nháº¥n nÃºt sáº½ gá»i <code>setClicked(true)</code>, cáº­p nháº­t trÆ°á»ng state Ä‘Æ°á»£c táº¡o bá»Ÿi <code>useState()</code>, Ä‘iá»u nÃ y khiáº¿n Preact render láº¡i thÃ nh pháº§n nÃ y. Khi thÃ nh pháº§n Ä‘Æ°á»£c render (gá»i) láº§n thá»© hai, giÃ¡ trá»‹ cá»§a biáº¿n state <code>clicked</code> sáº½ lÃ  <code>true</code>, vÃ  Virtual DOM tráº£ vá» sáº½ cÃ³ vÄƒn báº£n &quot;ÄÃ£ nháº¥n&quot; thay vÃ¬ &quot;ChÆ°a nháº¥n láº§n nÃ o&quot;. Äiá»u nÃ y khiáº¿n Preact cáº­p nháº­t ná»™i dung nÃºt trÃªn DOM.</p>\n<hr>\n\n\t\t\t\t<h2 id=\"thá»±c-hÃ nh\">\n\t\t\t\t\t<a class=\"fragment-link\" href=\"#thá»±c-hÃ nh\">\n\t\t\t\t\t\t<svg width=\"16\" height=\"16\" viewBox=\"0 0 24 24\" aria-label=\"Link to: Thá»±c hÃ nh! (#thá»±c-hÃ nh)\">\n\t\t\t\t\t\t\t<use href=\"/icons.svg#link\" ></use>\n\t\t\t\t\t\t</svg>\n\t\t\t\t\t</a>\n\t\t\t\t\t<span>Thá»±c hÃ nh!</span>\n\t\t\t\t</h2><p>HÃ£y thá»­ táº¡o má»™t bá»™ Ä‘áº¿m, báº¯t Ä‘áº§u tá»« mÃ£ chÃºng ta Ä‘Ã£ viáº¿t á»Ÿ chÆ°Æ¡ng trÆ°á»›c. ChÃºng ta sáº½ cáº§n lÆ°u trá»¯ má»™t sá»‘ <code>count</code> trong state, vÃ  tÄƒng giÃ¡ trá»‹ cá»§a nÃ³ lÃªn <code>1</code> má»—i khi nháº¥n nÃºt.</p>\n<p>VÃ¬ chÃºng ta Ä‘Ã£ dÃ¹ng thÃ nh pháº§n hÃ m á»Ÿ chÆ°Æ¡ng trÆ°á»›c, nÃªn cÃ³ thá»ƒ dá»… dÃ ng dÃ¹ng hooks, nhÆ°ng báº¡n cÃ³ thá»ƒ chá»n báº¥t ká»³ cÃ¡ch lÆ°u trá»¯ state nÃ o báº¡n thÃ­ch.</p>\n<solution>\n  <h4>ğŸ‰ ChÃºc má»«ng!</h4>\n  <p>Báº¡n Ä‘Ã£ há»c cÃ¡ch sá»­ dá»¥ng state!</p>\n</solution>\n\n\n\n\n\n\n\n"}