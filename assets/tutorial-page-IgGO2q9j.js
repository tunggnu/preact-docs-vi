import{d as _,c as t,K as A,u as G,i as J,A as w,x as y,y as a,j as Q,E as F,S as N,M as X,C as Y,k as Z,e as tt,R as ot,q as et,l as nt,T as lt,m as rt,n as u,a as H,t as st,N as it,f as ut,p as at}from"./index-CLtuOrgi.js";import{p as ct}from"./errors-5GnIWnWA.js";const x=A({});function dt({children:n}){const[o,l]=_(!1);return t(x.Provider,{value:{solved:o,setSolved:l},children:n})}const I=A(null),pt="_tutorial_14ply_1",ht="_tutorialWrapper_14ply_25",_t="_solvable_14ply_32",ft="_solved_14ply_32",vt="_nextButton_14ply_32",Ct="_tutorialWindow_14ply_38",gt="_solution_14ply_110",wt="_buttonContainer_14ply_148",yt="_helpButton_14ply_154",xt="_prevButton_14ply_155",bt="_showCode_14ply_191",St="_codeWindow_14ply_204",Tt="_code_14ply_128",mt="_output_14ply_253",Et="_toggleCode_14ply_263",s={tutorial:pt,tutorialWrapper:ht,solvable:_t,solved:ft,nextButton:vt,tutorialWindow:Ct,solution:gt,buttonContainer:wt,helpButton:yt,prevButton:xt,showCode:bt,codeWindow:St,code:Tt,output:mt,toggleCode:Et},m=new Set,E=new Set,B=new Set;let C,g;function Bt({html:n,meta:o}){var O,P,L;const{route:l,url:i}=G(),[c,p]=_(((O=o.tutorial)==null?void 0:O.initial)||""),[h,f]=_(c),[d,b]=_(null),[S,$]=J(e=>!e,!0),R=w(null),v=w(null),W=y(x),k=o.code!==!1,T=S&&k;if(typeof window>"u")return null;a(()=>{var e;(e=o.tutorial)!=null&&e.initial&&c!==o.tutorial.initial&&(p(o.tutorial.initial),f(o.tutorial.initial),W.setSolved(!1),R.current.scrollTo(0,0))},[(P=o.tutorial)==null?void 0:P.initial]),a(()=>{const e=setTimeout(()=>{f(c)},250);return()=>clearTimeout(e)},[c]);const V=e=>{a(()=>(m.add(e),()=>m.delete(e)),[e])},j=e=>{a(()=>{E.add(e);let r=v.current;return r&&r.realm&&r.realm.globalThis._require&&q(r.realm),()=>E.delete(e)},[e])},z=e=>{a(()=>(B.add(e),()=>B.delete(e)),[e])},K=e=>{B.forEach(r=>r(e)),b(e)},U=()=>{C&&C.forEach(e=>e()),C=[],m.forEach(e=>{let r=e(v.current);r&&C.push(r)}),b(null)},q=e=>{g&&g.forEach(r=>r()),g=[],E.forEach(r=>{let M=r(e);M&&g.push(M)})},D=()=>{var e,r;(e=o.tutorial)!=null&&e.final&&(l(`${i}?solved`,!0),p((r=o.tutorial)==null?void 0:r.final))};return t(I.Provider,{value:this,children:t("div",{class:Q(s.tutorialWrapper,o.solvable&&s.solvable,W.solved&&s.solved,T&&s.showCode),children:t(F,{children:t(N,{orientation:"horizontal",force:T?void 0:"100%",other:t(N,{orientation:"vertical",other:t(Z,{children:[t("div",{class:s.output,children:[d&&t(tt,{name:d.name,message:d.message,stack:ct(d)}),t(ot,{ref:v,onSuccess:U,onRealm:q,onError:K,code:h})]}),k&&t("button",{class:s.toggleCode,title:"Toggle Code",onClick:$,children:t("span",{children:"Toggle Code"})})]}),children:t("div",{class:s.codeWindow,children:t(Y,{class:s.code,value:c,error:d,slug:i,onInput:p})})}),children:t("div",{class:s.tutorialWindow,ref:R,children:[t(X,{html:n,meta:o,components:kt}),((L=o.tutorial)==null?void 0:L.setup)&&t(Wt,{code:o.tutorial.setup,runner:v,useResult:V,useRealm:j,useError:z}),t(Rt,{meta:o,showCode:T,help:D})]})})})})})}function Rt({meta:n,showCode:o,help:l}){const[i]=rt();return t("div",{class:s.buttonContainer,children:[n.prev&&t("a",{class:s.prevButton,href:n.prev,children:u.i18n.previous[i]||u.i18n.previous.en}),n.solvable&&t("button",{class:s.helpButton,onClick:l,disabled:!o,title:"Show solution to this example",children:u.i18n.tutorial.solve[i]||u.i18n.tutorial.solve.en}),n.next&&t("a",{class:s.nextButton,href:n.next,children:n.code==!1?u.i18n.tutorial.begin[i]||u.i18n.tutorial.begin.en:u.i18n.next[i]||u.i18n.next.en})]})}function Wt({code:n,runner:o,useResult:l,useRealm:i,useError:c}){const p=et(()=>{if(typeof window>"u")return null;const h=y(I),f=y(x),d=S=>o.current.realm.globalThis._require(S);return new Function("options","state","setState","useState","useEffect","useRef","useMemo","useResult","useRealm","useError","solutionCtx","realm","require",n)(nt,h.state,h.setState.bind(h),_,a,w,lt,l,i,c,f,o.current&&o.current.realm,d),null},[n]);return t(p,{})}const kt={Solution:qt};function qt({children:n}){const{solved:o}=y(x),l=w(null);return a(()=>{o&&requestAnimationFrame(()=>{l.current&&l.current.scrollIntoView({behavior:"smooth"})})},[o]),o?t("div",{ref:l,class:s.solution,children:n}):null}function Mt(){const{step:n}=H().params,o=st[`/tutorial${n?`/${n}`:""}`];return t(F,{children:o?t(Ot,{}):t(it,{})})}function Ot(){const{path:n}=H(),{html:o,meta:l}=ut(n);return a(()=>{l&&l.next&&at(l.next)},[l.next,n]),t("div",{class:s.tutorial,children:[t("style",{children:`
				main {
					height: 100% !important;
					overflow: hidden !important;
				}
			`}),t(dt,{children:t(Bt,{html:o,meta:l})})]})}export{Mt as default};